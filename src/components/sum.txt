<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>GSAP Section Scroll</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollToPlugin.min.js"></script>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: Arial, sans-serif;
      overflow-x: hidden;
    }

    .container {
      position: relative;
    }

    .section {
      height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 3rem;
      font-weight: bold;
      color: white;
      position: relative;
    }

    .section-1 {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    }

    .section-2 {
      background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
    }

    .section-3 {
      background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
    }

    .floating-element {
      position: fixed;
      width: 100px;
      height: 100px;
      background: white;
      border-radius: 20px;
      box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 2rem;
      z-index: 1000;
      will-change: transform;
    }

    .nav-hint {
      position: fixed;
      bottom: 30px;
      left: 50%;
      transform: translateX(-50%);
      color: white;
      font-size: 0.9rem;
      z-index: 1001;
      text-align: center;
      opacity: 0.8;
    }

    .splash-text {
      position: fixed;
      top: 40%;
      left: 50%;
      transform: translate(-50%, -50%);
      color: white;
      font-size: 4rem;
      font-weight: bold;
      z-index: 2000;
      opacity: 0;
      text-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- <div class="section section-0" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">Welcome</div> -->
    <div class="section section-1">Section 1</div>
    <div class="section section-2">Section 2</div>
    <div class="section section-3">Section 3</div>
  </div>

  <div class="splash-text">Welcome</div>
  <div class="floating-element">✨</div>
  <div class="nav-hint">Use arrow keys ↑↓, scroll wheel, or drag scrollbar</div>

  <script>
    const sections = document.querySelectorAll('.section');
    const floatingEl = document.querySelector('.floating-element');
    const splashText = document.querySelector('.splash-text');
    
    let isAnimating = false;
    let currentStep = 0; // 0 = initial, 1 = faded in at section 1, 2 = section 2, 3 = section 3
    let splashComplete = false;
    let interactionEnabled = false;

    // Define positions for each step (top, left in %)
    const positions = [
      { top: 50, left: 50, opacity: 0, scale: 0.8 }, // Step 0: Initial state
      { top: 50, left: 50, opacity: 1, scale: 1.0 }, // Step 1: Faded in at section 1
      { top: 60, left: 40, opacity: 1, scale: 1.0 }, // Step 2: Section 2
      { top: 50, left: 70, opacity: 1, scale: 1.0 }  // Step 3: Section 3
    ];

    const customEase = "power1.inOut";

    // Splash screen animation on load
    function playSplashScreen() {
      // Animate splash text: fade in, scale up, slide down
      gsap.fromTo(splashText, 
        {
          opacity: 0,
          scale: 0.5,
          y: -50
        },
        {
          opacity: 1,
          scale: 1,
          y: 0,
          duration: 1.2,
          ease: "back.out(1.7)",
          onComplete: () => {
            // Hold for a moment, then fade out
            gsap.to(splashText, {
              opacity: 0,
              y: 50,
              duration: 0.8,
              delay: 0.5,
              ease: "power2.in",
              onComplete: () => {
                splashText.style.display = 'none';
                splashComplete = true;
                interactionEnabled = true;
              }
            });
          }
        }
      );
    }

    // Animate floating element to a specific step
    function animateFloatingElement(targetStep) {
      if (targetStep < 0 || targetStep >= positions.length) return;
      
      const pos = positions[targetStep];
      gsap.to(floatingEl, {
        top: `${pos.top}%`,
        left: `${pos.left}%`,
        xPercent: -50,
        yPercent: -50,
        opacity: pos.opacity,
        scale: pos.scale,
        duration: 1.5,
        ease: customEase
      });
    }

    // Handle step progression
    function goToStep(targetStep) {
      if (!interactionEnabled || isAnimating || targetStep === currentStep || targetStep < 0 || targetStep >= positions.length) {
        return;
      }

      isAnimating = true;
      
      // Step 0 -> 1: Just animate floating element, don't scroll
      if (currentStep === 0 && targetStep === 1) {
        animateFloatingElement(1);
        setTimeout(() => {
          currentStep = 1;
          isAnimating = false;
        }, 1500);
      }
      // Step 1 -> 2: Scroll to section 2 and animate element
      else if (currentStep === 1 && targetStep === 2) {
        gsap.to(window, {
          scrollTo: window.innerHeight,
          duration: 1.5,
          ease: customEase
        });
        animateFloatingElement(2);
        setTimeout(() => {
          currentStep = 2;
          isAnimating = false;
        }, 1500);
      }
      // Step 2 -> 3: Scroll to section 3 and animate element
      else if (currentStep === 2 && targetStep === 3) {
        gsap.to(window, {
          scrollTo: window.innerHeight * 2,
          duration: 1.5,
          ease: customEase
        });
        animateFloatingElement(3);
        setTimeout(() => {
          currentStep = 3;
          isAnimating = false;
        }, 1500);
      }
      // Going backwards
      else if (targetStep < currentStep) {
        const targetScroll = Math.max(0, (targetStep - 1) * window.innerHeight);
        gsap.to(window, {
          scrollTo: targetScroll,
          duration: 1.5,
          ease: customEase
        });
        animateFloatingElement(targetStep);
        setTimeout(() => {
          currentStep = targetStep;
          isAnimating = false;
        }, 1500);
      }
    }

    // Handle wheel events
    let wheelTimeout;
    window.addEventListener('wheel', (e) => {
      if (!interactionEnabled || isAnimating) return;
      
      clearTimeout(wheelTimeout);
      wheelTimeout = setTimeout(() => {
        if (e.deltaY > 0) {
          // Scroll down
          goToStep(currentStep + 1);
        } else if (e.deltaY < 0) {
          // Scroll up
          goToStep(currentStep - 1);
        }
      }, 50);
    }, { passive: true });

    // Handle keyboard events
    document.addEventListener('keydown', (e) => {
      if (!interactionEnabled || isAnimating) return;
      
      if (e.key === 'ArrowDown') {
        e.preventDefault();
        goToStep(currentStep + 1);
      } else if (e.key === 'ArrowUp') {
        e.preventDefault();
        goToStep(currentStep - 1);
      }
    });

    // Prevent manual scrolling during splash
    window.addEventListener('scroll', (e) => {
      if (!splashComplete) {
        window.scrollTo(0, 0);
      }
    });

    // Initialize
    animateFloatingElement(0);
    playSplashScreen();
  </script>
</body>
</html>